{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "EventOptionController"
    },
    "designerId": "04f38f0c-c5fe-4613-b6ad-5fb0367dc5e8",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#optionsEvent",
                "designer|targetType": "Ext.button.Button",
                "fn": "optionsEventClick",
                "implHandler": [
                    "this.eventOptionButton();"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "a93cd165-987e-4ba4-bfd1-bdaec9238eaf"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#modEventOptionSubmit",
                "designer|targetType": "Ext.button.Button",
                "fn": "modEventOptionSubmitClick",
                "implHandler": [
                    "if(syncTaskEvent === null) {",
                    "    this.taskFunction();",
                    "} else {",
                    "    syncTaskEvent.stop();",
                    "}",
                    "",
                    "this.eventOptionSubmitButton();"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "0d5eafba-e415-47d6-8655-6da15b0b0266"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#myviewport",
                "designer|targetType": "Ext.container.Viewport",
                "fn": "viewportBeforeRender",
                "implHandler": [
                    "this.taskFunction();"
                ],
                "name": "beforerender",
                "scope": "me"
            },
            "designerId": "94423820-7abe-4532-8851-21baa189dfc5"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "ModEventOptionWindow",
                "selector": "ModEventOptionWindow_ua"
            },
            "designerId": "f024a435-698c-4d0d-b1a9-634d8a4779e8"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "eventOptionButton",
                "implHandler": [
                    "var mySelf = this;",
                    "",
                    "Ext.Ajax.request({",
                    "    url: \"resources/libraries/syncbookServices/optionService.php\",",
                    "    params: {",
                    "        syncType: \"caldav\"",
                    "    },",
                    "",
                    "    success: function(response) {",
                    "        var operationResult = Ext.decode(response.responseText);",
                    "",
                    "        if(operationResult.option.errorSuccess != 'undefined' && operationResult.option.errorSuccess === false) {",
                    "            console.error(\"An error with code : \"+operationResult.option.errorCode+\" has occoured = \"+operationResult.option.errorDescription);",
                    "        } else {",
                    "            var modEventOptionWindow = Ext.create(\"syncbook.view.ModEventOptionWindow\");",
                    "",
                    "            if(operationResult.option.syncflag*1 === 0) {",
                    "                mySelf.getModEventOptionWindow().getComponent('modEventOptionForm').getForm().findField('synctime').setDisabled(true);",
                    "            }",
                    "",
                    "            var toLoadSyncRecord = Ext.create(\"syncbook.model.SyncModel\", {",
                    "                synctype: operationResult.option.synctype,",
                    "                syncflag: operationResult.option.syncflag*1,",
                    "                synctime: operationResult.option.synctime",
                    "            });",
                    "",
                    "            mySelf.getModEventOptionWindow().getComponent('modEventOptionForm').loadRecord(toLoadSyncRecord);",
                    "            modEventOptionWindow.show();",
                    "        }",
                    "    },",
                    "",
                    "    failure: function(response) {",
                    "        Ext.Msg.show({",
                    "            title: \"Response Error\",",
                    "            msg: \"Response Error Message\",",
                    "            buttons: Ext.Msg.OK,",
                    "            closable: false,",
                    "            scope: this,",
                    "            icon: Ext.window.MessageBox.ERROR",
                    "        });",
                    "    }",
                    "});"
                ]
            },
            "designerId": "d7ed089c-7025-40c0-aa54-ecd3b7b5e1eb"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "eventOptionSubmitButton",
                "implHandler": [
                    "var mySelf = this;",
                    "",
                    "var auxiliarForm = mySelf.getModEventOptionWindow().getComponent('modEventOptionForm').getForm();",
                    "formRecord = auxiliarForm.getRecord();",
                    "auxiliarForm.updateRecord(formRecord);",
                    "auxiliarForm.clearInvalid();",
                    "",
                    "if(auxiliarForm.isValid()) {",
                    "    mySelf.getModEventOptionWindow().close();",
                    "    formRecord.setDirty();",
                    "",
                    "    Ext.Ajax.request({",
                    "        url: \"resources/libraries/syncbookServices/optionService.php\",",
                    "        params: {",
                    "            syncType: \"caldav\",",
                    "            newSyncOption: Ext.encode(formRecord.data)",
                    "        },",
                    "",
                    "        success: function(response) {",
                    "            var operationResult = Ext.decode(response.responseText);",
                    "",
                    "            if(operationResult.option.errorSuccess != 'undefined' && operationResult.option.errorSuccess === false) {",
                    "                console.error(\"An error with code : \"+operationResult.option.errorCode+\" has occoured = \"+operationResult.option.errorDescription);",
                    "            } else {",
                    "                mySelf.taskFunction();",
                    "            }",
                    "        },",
                    "",
                    "        failure: function(response) {",
                    "            Ext.Msg.show({",
                    "                title: \"Response Error\",",
                    "                msg: \"Response Error Message\",",
                    "                buttons: Ext.Msg.OK,",
                    "                closable: false,",
                    "                scope: this,",
                    "                icon: Ext.window.MessageBox.ERROR",
                    "            });",
                    "        }",
                    "    });",
                    "} else {",
                    "    Ext.Msg.show({",
                    "        title: \"Form Error\",",
                    "        msg: \"Uncorrect Form Compilation\",",
                    "        buttons: Ext.Msg.OK,",
                    "        closable: false,",
                    "        scope: this,",
                    "        icon: Ext.window.MessageBox.ERROR",
                    "    });",
                    "}"
                ]
            },
            "designerId": "524ab3b5-89a7-4f76-a9b0-1d54c528ac65"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "taskFunction",
                "implHandler": [
                    "Ext.Ajax.request({",
                    "    url: \"resources/libraries/syncbookServices/optionService.php\",",
                    "    params: {",
                    "        syncType: \"caldav\"",
                    "    },",
                    "",
                    "    success: function(response) {",
                    "        var operationResult = Ext.decode(response.responseText);",
                    "",
                    "        if(operationResult.option.errorSuccess != 'undefined' && operationResult.option.errorSuccess === false) {",
                    "            console.error(\"An error with code : \"+operationResult.option.errorCode+\" has occoured = \"+operationResult.option.errorDescription);",
                    "        } else {",
                    "",
                    "            if(operationResult.option.syncflag*1 == 1) {",
                    "                var runner = new Ext.util.TaskRunner();",
                    "",
                    "                syncTaskEvent = runner.newTask({",
                    "                    run: function () {",
                    "                        // console.log(\"Timestamp Event\", Ext.util.Format.date(new Date(), 'H:i:s'));",
                    "                        syncbook.app.getController('EventActionController').syncEventsFunction();",
                    "                    },",
                    "",
                    "                    interval: operationResult.option.synctime*1000",
                    "                });",
                    "",
                    "                syncTaskEvent.start();",
                    "            } else {",
                    "                if(syncTaskEvent !== null)",
                    "                    syncTaskEvent.stop();",
                    "            }",
                    "        }",
                    "    },",
                    "",
                    "    failure: function(response) {",
                    "        Ext.Msg.show({",
                    "            title: \"Response Error\",",
                    "            msg: \"Response Error Message\",",
                    "            buttons: Ext.Msg.OK,",
                    "            closable: false,",
                    "            scope: this,",
                    "            icon: Ext.window.MessageBox.ERROR",
                    "        });",
                    "    }",
                    "});"
                ]
            },
            "designerId": "3c4364ea-35d6-4b31-bdf9-6005d435ccc5"
        }
    ]
}